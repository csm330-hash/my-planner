<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ë¬´ì´ì¹˜ë¡œ ì•ˆê°œ í˜¸í¡ í”Œë˜ë„ˆ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Black+Han+Sans&family=Noto+Sans+KR:wght@400;700&display=swap');
        body { font-family: 'Noto+Sans+KR', sans-serif; background-color: #0f172a; color: #ccfbf1; } /* ì–´ë‘ìš´ ë°°ê²½ì— ë¯¼íŠ¸ìƒ‰ í¬ì¸íŠ¸ */
        .muichiro-font { font-family: 'Black Han Sans', sans-serif; }
        .card { background: rgba(30, 41, 59, 0.8); border: 2px solid #2dd4bf; border-radius: 20px; padding: 1.5rem; }
        .sticker-slot { width: 50px; height: 50px; border: 2px dashed #5eead4; border-radius: 50%; display: flex; align-items: center; justify-content: center; cursor: pointer; transition: 0.3s; }
        .sticker-active { background: #2dd4bf; border-style: solid; font-size: 1.5rem; box-shadow: 0 0 15px #2dd4bf; }
        .btn-action { background: #14b8a6; color: #0f172a; font-weight: bold; border-radius: 12px; padding: 10px; }
    </style>
</head>
<body class="p-4 md:p-8">
    <div class="max-w-2xl mx-auto space-y-6">
        <header class="text-center py-4">
            <h1 class="muichiro-font text-4xl text-teal-300 tracking-widest">ì•ˆê°œì˜ í˜¸í¡ í”Œë˜ë„ˆ</h1>
            <p class="text-teal-500 mt-2">ë¬´ì´ì¹˜ë¡œì™€ í•¨ê»˜ ëª©í‘œë¥¼ ë‹¬ì„±í•˜ì!</p>
        </header>

        <section class="card shadow-2xl">
            <div class="flex justify-between items-center mb-4">
                <h2 class="text-xl font-bold text-teal-300"><i class="fas fa-certificate mr-2"></i>ì¹­ì°¬ ìŠ¤í‹°ì»¤ íŒ</h2>
                <span id="sticker-count" class="text-xs font-bold">0 / 20</span>
            </div>
            <div id="sticker-board" class="grid grid-cols-5 gap-4 justify-items-center">
                </div>
            <button onclick="resetStickers()" class="w-full mt-6 text-[10px] text-teal-700 underline">íŒ ì´ˆê¸°í™”</button>
        </section>

        <section class="card">
            <h2 class="text-xl font-bold mb-4 text-teal-300"><i class="fas fa-check-circle mr-2"></i>ì˜¤ëŠ˜ì˜ ìˆ˜ë ¨</h2>
            <div class="space-y-3" id="mission-list">
                <div class="flex items-center gap-3 bg-slate-800 p-3 rounded-xl">
                    <input type="checkbox" onchange="toggleMission(this)" class="w-6 h-6 accent-teal-400">
                    <span class="flex-1 font-bold">ìˆ˜í•™ ë¬¸ì œì§‘ 2ìª½ í’€ê¸°</span>
                </div>
                <div class="flex items-center gap-3 bg-slate-800 p-3 rounded-xl">
                    <input type="checkbox" onchange="toggleMission(this)" class="w-6 h-6 accent-teal-400">
                    <span class="flex-1 font-bold">ì˜ì–´ ë‹¨ì–´ 5ê°œ ì™¸ìš°ê¸°</span>
                </div>
            </div>
        </section>

        <section class="card bg-teal-900/30 border-teal-500/50">
            <h2 class="text-sm font-bold text-teal-400 mb-2">ë””ë ‰í„° ì—„ë§ˆì˜ ì „ë ¹</h2>
            <p id="mom-msg" class="text-lg leading-relaxed">"ì˜¤ëŠ˜ë„ ìš°ë¦¬ ì•„ë“¤, ë¬´ì´ì¹˜ë¡œì²˜ëŸ¼ ë©‹ì§€ê²Œ í•´ë‚´ë³´ì! ì‚¬ë‘í•´."</p>
        </section>
    </div>

    <script>
        const SON_GAS_URL = "https://script.google.com/macros/s/AKfycbx2FYClZYDylebG9MNucCIunPuvlGsXfJfR2i9idgpMxE4-8LSNt9FFvLEbM_uXtsYS/exec";
        let currentStickers = parseInt(localStorage.getItem('son-sticker-total') || '0');

        window.onload = () => {
            initStickerBoard();
            updateStickerDisplay();
        };

        // ìŠ¤í‹°ì»¤ íŒ ìƒì„±
        function initStickerBoard() {
            const board = document.getElementById('sticker-board');
            board.innerHTML = '';
            for (let i = 1; i <= 20; i++) {
                const isActive = i <= currentStickers;
                board.insertAdjacentHTML('beforeend', `
                    <div class="sticker-slot ${isActive ? 'sticker-active' : ''}" onclick="addSticker(${i})">
                        ${isActive ? 'ğŸŒ«ï¸' : ''}
                    </div>
                `);
            }
        }

        // ìŠ¤í‹°ì»¤ ì¶”ê°€ ë° ìë™ ì €ì¥
        function addSticker(index) {
            if (index === currentStickers + 1) {
                currentStickers++;
                localStorage.setItem('son-sticker-total', currentStickers);
                initStickerBoard();
                updateStickerDisplay();
                saveToCloud('Sticker Earned', `Total: ${currentStickers}`);
                playSuccessSound();
            }
        }

        function updateStickerDisplay() {
            document.getElementById('sticker-count').innerText = `${currentStickers} / 20`;
        }

        function resetStickers() {
            if(confirm("ì •ë§ ì´ˆê¸°í™”í• ê¹Œ?")) {
                currentStickers = 0;
                localStorage.setItem('son-sticker-total', '0');
                initStickerBoard();
                updateStickerDisplay();
                saveToCloud('Sticker Reset', 'Started over');
            }
        }

        async function saveToCloud(type, content) {
            try {
                await fetch(SON_GAS_URL, {
                    method: "POST",
                    mode: "no-cors",
                    body: JSON.stringify({ date: new Date().toLocaleDateString('sv-SE'), type: type, content: content })
                });
            } catch (e) { console.error("Cloud Error", e); }
        }

        function toggleMission(el) {
            if(el.checked) {
                saveToCloud('Mission Clear', el.nextElementSibling.innerText);
            }
        }

        function playSuccessSound() {
            const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
            const osc = audioCtx.createOscillator();
            const gain = audioCtx.createGain();
            osc.connect(gain); gain.connect(audioCtx.destination);
            osc.frequency.setValueAtTime(523.25, audioCtx.currentTime); // C5
            osc.frequency.exponentialRampToValueAtTime(1046.50, audioCtx.currentTime + 0.1); // C6
            gain.gain.setValueAtTime(0.1, audioCtx.currentTime);
            osc.start(); osc.stop(audioCtx.currentTime + 0.2);
        }
    </script>
</body>
</html>
